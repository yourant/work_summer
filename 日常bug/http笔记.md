1. 
OSI 七层模型

应用层
会话层
传输层
网络层
数据链路层
物理层


TCP/IP 模型

应用层
传输层
网络层
网络接口层 (ARP 和 RARP)

TCP 是长连接, 就是在一次会话完成后 这次 会话产生的 socket 资源不会释放 下次对话可以接着使用

HTTP 协议
HTTP 1.0 需要在 在请求头添加 Connection: keep-alive 就能保持会话

HTTP 1.1 默认就支持长连接, 如果要关闭, 需要使用 Connection: close
http的长连接不会一直保持一般来讲,会设置有效时间, 和最大连接数目, 超过时间或者数目就会自动关闭socket

协议是这样规定的但是支持不支持还需要看服务器和客户端的具体实现, 

遇到的问题

客户端不能向外部发送请求, 报错 connect error, 经过排查是客户端socket资源占用未释放, 导致不能产生新的socket, 需要在发起请求时添加 connection: close, 请求完成后就释放socket 资源

服务端某一个端口能同时打开多少个socket 

理论值是无限个, 对于linux而言, 一切操作皆文件 socket 也不例外, 而系统会默认限制一个进程能开启的文件句柄数
可以通过 ulimit -n 命令查看,  这个值不是唯一, 不同类型的系统也不一样
在我自己买的 阿里云服务器 是 65535
在我们的客户服务器是 1024

而我们开启的socket 数还需要减去 进程间通信所占用的socket 和一些句柄和考虑到进程打开的文件 所以实际值会比此处展示的句柄还少

, 所以这个限制也就对于某一个进程开启的socket数做了限制, socket是用来做本地数据和网络做通信

